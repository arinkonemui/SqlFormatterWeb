<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SQL整形ツール（高速・無料・ブラウザだけ）</title>
  <meta name="description" content="SQLをブラウザだけでサッと整形。MySQL/PostgreSQL/SQLite/SQL Server対応。データ送信なし＆完全無料。" />
  <style>
    :root { --bg:#0f172a; --card:#111827; --muted:#94a3b8; --fg:#e5e7eb; --acc:#22d3ee; }
    *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    .title{font-size:24px;font-weight:800;letter-spacing:.5px}
    .card{background:var(--card);border:1px solid #1f2937;border-radius:14px;padding:16px;box-shadow:0 10px 30px rgb(0 0 0 / .25)}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .row > *{margin:4px 0}
    select, input[type="number"], input[type="checkbox"]{background:#0b1220;border:1px solid #243045;color:var(--fg);border-radius:10px;padding:8px 10px}
    textarea{width:100%;min-height:180px;background:#0b1220;border:1px solid #243045;border-radius:12px;color:var(--fg);padding:12px;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
    .out{min-height:220px;white-space:pre;overflow:auto}
    .btn{background:#0b1220;border:1px solid #334155;color:var(--fg);padding:10px 14px;border-radius:10px;cursor:pointer}
    .btn:hover{border-color:#475569}
    .btn.primary{border-color:#0ea5b7;background:linear-gradient(180deg,#0ea5b7,#0b7782);font-weight:700}
    .muted{color:var(--muted);font-size:13px}
    .footer{margin-top:18px;color:#9ca3af;font-size:12px}
    .badge{display:inline-block;padding:2px 8px;border:1px solid #334155;border-radius:999px;font-size:12px;color:#cbd5e1}
  </style>
  <!-- sql-formatter (UMD) -->
  <script src="https://unpkg.com/sql-formatter/dist/sql-formatter.min.js"></script>
</head>
<body>
  <div class="wrap">
    <div class="row" style="justify-content:space-between">
      <div class="title">SQL整形ツール</div>
      <div class="badge">ローカル実行 / データ送信なし</div>
    </div>

    <div class="card" style="margin-top:14px">
      <div class="row">
        <label>方言
          <select id="dialect">
            <option value="sql">Standard SQL</option>
            <option value="mysql">MySQL</option>
            <option value="postgresql">PostgreSQL</option>
            <option value="sqlite">SQLite</option>
            <option value="tsql">SQL Server (T-SQL)</option>
          </select>
        </label>
        <label>インデント
          <input id="indent" type="number" min="2" max="8" step="1" value="2" />
        </label>
        <label><input id="uppercase" type="checkbox" /> キーワードを大文字に</label>

        <button class="btn primary" id="formatBtn">整形</button>
        <button class="btn" id="minifyBtn">ミニファイ</button>
        <button class="btn" id="copyBtn">コピー</button>
        <button class="btn" id="clearBtn">クリア</button>
      </div>

      <div style="margin-top:10px">
        <div class="muted">入力（SQL）</div>
        <textarea id="input" placeholder="SELECT * from users where id=1 AND status='active' order by created_at desc;"></textarea>
      </div>

      <div style="margin-top:10px">
        <div class="muted">出力</div>
        <pre id="output" class="out"></pre>
      </div>

      <div class="footer">
        使い方：SQLをペースト → 「整形」。最小化したい場合は「ミニファイ」。<br/>
        免責：本ツールの利用によるいかなる損害も開発者は責任を負いません。
      </div>
    </div>

    <div class="card" style="margin-top:12px">
      <div class="muted">プライバシー</div>
      このサイトは入力内容をサーバに送信しません。ブラウザ内でのみ処理します。広告を表示する場合、第三者のCookie等が利用されることがあります。
    </div>

    <!-- 広告（後で差し込み）：AdSense 自動広告 or レスポンシブ広告ユニット -->
    <!-- 例：<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXX" crossorigin="anonymous"></script> -->

  </div>

  <script>
    const $ = (s)=>document.querySelector(s);
    const input = $('#input'), output = $('#output');
    const dialect = $('#dialect'), indent = $('#indent'), uppercase = $('#uppercase');

    function formatNow(){
      try{
        const sql = input.value || '';
        const opt = {
          language: dialect.value,
          indent: ' '.repeat(Math.max(2, Math.min(8, Number(indent.value)||2))),
          uppercase: !!uppercase.checked
        };
        const res = window.sqlFormatter.format(sql, opt);
        output.textContent = res;
      }catch(e){
        output.textContent = '整形に失敗しました: ' + (e?.message||e);
      }
    }

    function minifyNow(){
      const sql = input.value || '';
      // 超簡易ミニファイ（コメント/空白を潰す）。必要に応じて強化。
      const noComments = sql.replace(/--.*?$|\/\*[\s\S]*?\*\//gm,'');
      const mini = noComments.replace(/\s+/g,' ').trim();
      output.textContent = mini;
    }

    $('#formatBtn').addEventListener('click', formatNow);
    $('#minifyBtn').addEventListener('click', minifyNow);
    $('#copyBtn').addEventListener('click', async ()=>{
      const text = output.textContent || '';
      try{ await navigator.clipboard.writeText(text);
           alert('コピーしました'); } catch{ alert('コピーに失敗しました'); }
    });
    $('#clearBtn').addEventListener('click', ()=>{
      input.value=''; output.textContent='';
    });

    // サンプルを即整形
    formatNow();
  </script>
</body>
</html>
